<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Model Builders for the Gradient Boosting Frameworks &mdash; daal4py 2021 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Algorithms" href="algorithms.html" />
    <link rel="prev" title="Input Data" href="data.html" />
    <script defer type="text/javascript" src="https://www.intel.com/content/dam/www/global/wap/performance-config.js" ></script>
    <script type="text/javascript">
        // Configure TMS settings
        var wapLocalCode = 'us-en'; // Dynamically set per localized site, see mapping table for values
        var wapSection = "scikit-learn"; // WAP team will give you a unique section for your site
        // Load TMS
        if(document.location.href.contains("intel.github.io/scikit-learn-intelex")){
          (function () {
            var url = 'https://www.intel.com/content/dam/www/global/wap/tms-loader.js'; // WAP file URL
            var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true; po.src = url;
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
          })();
      }
      </script>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="contents.html" class="icon icon-home">
            daal4py
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">About daal4py</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">Data</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Model Builders</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#conversion">Conversion</a></li>
<li class="toctree-l2"><a class="reference internal" href="#classification-and-regression-inference">Classification and Regression Inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="#limitations">Limitations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#examples">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="#articles-and-blog-posts">Articles and Blog Posts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.html">Supported Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="scaling.html">Distributed Mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="streaming.html">Streaming Mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="sklearn.html">Scikit-Learn API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="contents.html">daal4py</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="contents.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Model Builders for the Gradient Boosting Frameworks</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/model-builders.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="model-builders-for-the-gradient-boosting-frameworks">
<span id="model-builders"></span><h1>Model Builders for the Gradient Boosting Frameworks<a class="headerlink" href="#model-builders-for-the-gradient-boosting-frameworks" title="Permalink to this heading"></a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading"></a></h2>
<p>Gradient boosting on decision trees is one of the most accurate and efficient
machine learning algorithms for classification and regression.
The most popular implementations of it are the XGBoost*,
LightGBM*, and CatBoost* frameworks.
daal4py Model Builders deliver the accelerated
models inference of those frameworks. The inference is performed by the oneDAL GBT implementation tuned
for the best performance on the Intel(R) Architecture.</p>
</section>
<section id="conversion">
<h2>Conversion<a class="headerlink" href="#conversion" title="Permalink to this heading"></a></h2>
<p>The first step is to convert already trained model. There are similar
APIs for different frameworks.
XGBoost:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">daal4py</span> <span class="k">as</span> <span class="nn">d4p</span>
<span class="n">d4p_model</span> <span class="o">=</span> <span class="n">d4p</span><span class="o">.</span><span class="n">get_gbt_model_from_xgboost</span><span class="p">(</span><span class="n">xgb_model</span><span class="p">)</span>
</pre></div>
</div>
<p>LightGBM:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">daal4py</span> <span class="k">as</span> <span class="nn">d4p</span>
<span class="n">d4p_model</span> <span class="o">=</span> <span class="n">d4p</span><span class="o">.</span><span class="n">get_gbt_model_from_lightgbm</span><span class="p">(</span><span class="n">lgb_model</span><span class="p">)</span>
</pre></div>
</div>
<p>CatBoost:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">daal4py</span> <span class="k">as</span> <span class="nn">d4p</span>
<span class="n">d4p_model</span> <span class="o">=</span> <span class="n">d4p</span><span class="o">.</span><span class="n">get_gbt_model_from_catboost</span><span class="p">(</span><span class="n">cb_model</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Convert model only once and then use it for the inference.</p>
</div>
</section>
<section id="classification-and-regression-inference">
<h2>Classification and Regression Inference<a class="headerlink" href="#classification-and-regression-inference" title="Permalink to this heading"></a></h2>
<p>GBT implementation in daal4py assumes separate APIs for the classification and regression.
Specify the corresponding API and match the corresponding problem
in the initial framework.</p>
<p>Classification:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d4p_cls_algo</span> <span class="o">=</span> <span class="n">d4p</span><span class="o">.</span><span class="n">gbt_classification_prediction</span><span class="p">(</span>
    <span class="n">nClasses</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;classes_count&#39;</span><span class="p">],</span>
    <span class="n">resultsToEvaluate</span><span class="o">=</span><span class="s2">&quot;computeClassLabels&quot;</span><span class="p">,</span>
    <span class="n">fptype</span><span class="o">=</span><span class="s1">&#39;float&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Regression:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d4p_reg_algo</span> <span class="o">=</span> <span class="n">d4p</span><span class="o">.</span><span class="n">gbt_regression_prediction</span><span class="p">()</span>
</pre></div>
</div>
<p>Next, daal4py algorithm object needs compute method to be called.
Both the data and the previously converted model should be passed with the results of the prediction
available within the  <code class="docutils literal notranslate"><span class="pre">.prediction</span></code> parameter.</p>
<p>Compute:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d4p_predictions</span> <span class="o">=</span> <span class="n">d4p_reg_algo</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">d4p_model</span><span class="p">)</span><span class="o">.</span><span class="n">prediction</span>
</pre></div>
</div>
<p>The one-line variant of the same code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d4p_prediction</span> <span class="o">=</span> <span class="n">d4p</span><span class="o">.</span><span class="n">gbt_regression_prediction</span><span class="p">()</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">d4p_model</span><span class="p">)</span><span class="o">.</span><span class="n">prediction</span>
</pre></div>
</div>
</section>
<section id="limitations">
<h2>Limitations<a class="headerlink" href="#limitations" title="Permalink to this heading"></a></h2>
<p>Missing Values (NaN)
Note that there is temporary limitation on the use of missing values
(NaN) during training and prediction. This problem is addressed on
the master branch and to be available in the 2023.2 release.</p>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this heading"></a></h2>
<p>Model Builders models conversion</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/intel/scikit-learn-intelex/blob/master/examples/daal4py/gbt_cls_model_create_from_xgboost_batch.py">XGBoost model conversion</a></p></li>
<li><p><a class="reference external" href="https://github.com/intel/scikit-learn-intelex/blob/master/examples/daal4py/gbt_cls_model_create_from_lightgbm_batch.py">LightGBM model conversion</a></p></li>
<li><p><a class="reference external" href="https://github.com/intel/scikit-learn-intelex/blob/master/examples/daal4py/gbt_cls_model_create_from_catboost_batch.py">CatBoost model conversion</a></p></li>
</ul>
</section>
<section id="articles-and-blog-posts">
<h2>Articles and Blog Posts<a class="headerlink" href="#articles-and-blog-posts" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://medium.com/intel-analytics-software/improving-the-performance-of-xgboost-and-lightgbm-inference-3b542c03447e">Improving the Performance of XGBoost and LightGBM Inference</a></p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="data.html" class="btn btn-neutral float-left" title="Input Data" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="algorithms.html" class="btn btn-neutral float-right" title="Algorithms" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Intel.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>